<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1a73e8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Scoutier">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiU2NvdXRpZXIgLSBFbWFpbCBPdXRyZWFjaCIsInNob3J0X5hbWUiOiJTY291dGllciIsInN0YXJ0X3VybCI6Ii8iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsImJhY2tncm91bmRfY29sb3IiOiIjZjhmOWZhIiwidGhlbWVfY29sb3IiOiIjMWE3M2U4IiwiaWNvbnMiOlt7InNyYyI6ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCUUNBSUFBQUNXMDFTSkFBQUFFRWxFUVZSWUdLM1o1MVlSS3dBVkFBQUEiLCJzaXplcyI6IjgweDgwIiwidHlwZSI6ImltYWdlL3BuZyJ9XX0=">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BGZ0365NTS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-BGZ0365NTS');
    </script>
  
    <!-- Primary Meta Tags -->
    <title>Scoutier - Advanced Bulk Email Outreach Tool PWA</title>
    <meta name="description" content="Scoutier is a lightning-fast PWA email outreach tool that works offline. Send personalized emails in bulk with smart automation and scheduling.">
    <meta name="keywords" content="Scoutier, email outreach, bulk emails, PWA, offline email tool, email automation">
    <meta name="author" content="Scoutier Team">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook Meta Tags -->
    <meta property="og:title" content="Scoutier - PWA Bulk Email Outreach Tool">
    <meta property="og:description" content="Lightning-fast PWA for bulk email outreach. Works offline with smart automation and scheduling features.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.scoutier.com.ng">
    <meta property="og:image" content="https://www.scoutier.com.ng/assets/images/scoutier-og-image.png">
    <meta property="og:site_name" content="Scoutier">
    
    <!-- Twitter Cards Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Scoutier - PWA Email Outreach Tool">
    <meta name="twitter:description" content="Lightning-fast PWA for bulk email outreach with offline capabilities and smart automation.">
    <meta name="twitter:image" content="https://www.scoutier.com.ng/assets/images/scoutier-twitter-image.png">
    <meta name="twitter:site" content="@scoutier">
    <meta name="twitter:creator" content="@scoutier">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.scoutier.com.ng">

    <!-- Favicon -->
    <link rel="icon" href="https://res.cloudinary.com/dib5bkbsy/image/upload/v1732499785/icons8-mail-32_z9jaip.png" type="image/x-icon">

    <!-- Remixicon -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
   
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        blue: {
                            500: '#1a73e8',
                            600: '#0d62d0'
                        },
                        green: {
                            500: '#34a853'
                        },
                        yellow: {
                            500: '#fbbc05'
                        },
                        red: {
                            500: '#ea4335'
                        },
                        purple: {
                            500: '#8c5eff'
                        }
                    },
                    fontFamily: {
                        'google-sans': ['Google Sans', 'system-ui', '-apple-system', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <style>
        :root {
            --blue-500: #1a73e8;
            --green-500: #34a853;
            --yellow-500: #fbbc05;
            --red-500: #ea4335;
            --purple-500: #8c5eff;
        }
        
        body {
            font-family: 'Google Sans', system-ui, -apple-system, sans-serif;
            background-color: #f8f9fa;
            color: #202124;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .dark body {
            background-color: #202124;
            color: #e8eaed;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.2); border-radius: 2px; }
        .dark ::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.2); }

        /* Gmail-style Components */
        .gmail-card {
            background-color: white;
            border-radius: 12px;
            border: 1px solid rgba(0, 0, 0, 0.04);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
            transition: box-shadow 0.2s ease;
        }
        
        .gmail-card:hover { 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); 
        }
        
        .dark .gmail-card {
            background-color: #2d2e30;
            border-color: rgba(255, 255, 255, 0.06);
        }

        .gmail-btn {
            background-color: var(--blue-500);
            color: white;
            border-radius: 6px;
            font-weight: 500;
            font-size: 14px;
            box-shadow: 0 1px 3px rgba(60, 64, 67, 0.15);
            transition: all 0.15s ease;
            border: none;
            cursor: pointer;
        }

        .gmail-btn:hover {
            background-color: #0d62d0;
            transform: translateY(-1px);
        }
        
        .gmail-btn-secondary {
            background-color: white;
            color: var(--blue-500);
            border: 1px solid #dadce0;
            font-weight: 500;
            transition: all 0.15s ease;
        }
        
        .gmail-btn-secondary:hover {
            background-color: #f8f9fa;
            border-color: var(--blue-500);
        }
        
        .dark .gmail-btn-secondary {
            background-color: #2d2e30;
            color: #8ab4f8;
            border-color: #5f6368;
        }
        
        .gmail-input {
            border-radius: 8px;
            border: 1px solid #dadce0;
            padding: 10px 14px;
            font-family: inherit;
            transition: all 0.15s ease;
            background-color: white;
        }
        
        .gmail-input:focus {
            border-color: var(--blue-500);
            outline: none;
            box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.12);
        }
        
        .dark .gmail-input {
            border-color: #5f6368;
            background-color: #2d2e30;
            color: #e8eaed;
        }

        /* Template Chips */
        .template-chip {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            background-color: #f0f4f9;
            color: var(--blue-500);
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
            margin-right: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.15s ease;
        }
        
        .template-chip:hover {
            background-color: #e4ebf5;
            border-color: var(--blue-500);
        }
        
        .dark .template-chip {
            background-color: #3c4043;
            color: #8ab4f8;
        }

        /* Email Links */
        .email-link {
            padding: 3px 5px;
            border-radius: 4px;
            margin-bottom: 2px;
            font-size: 12px;
            font-weight: 400;
            transition: background-color 0.1s ease;
            display: block;
            color: var(--green-500);
            text-decoration: none;
        }
        
        .email-link:hover {
            background-color: rgba(26, 115, 232, 0.1);
        }
        
        .email-link.sent {
            color: orange;
        }

        /* Progress Bar */
        #globalProgressBar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: #e0e0e0;
            z-index: 9999;
            transform: translateY(-100%);
            transition: transform 0.2s ease;
        }
        
        #globalProgressBar.show { 
            transform: translateY(0); 
        }
        
        #globalProgressBar .progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--green-500);
            transition: width 0.1s linear;
        }

        /* Floating Button */
        .floating-btn {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background-color: var(--blue-500);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3);
            cursor: pointer;
            transition: all 0.2s ease;
            z-index: 100;
            opacity: 0;
            transform: scale(0);
            border: none;
        }
        
        .floating-btn.visible {
            opacity: 1;
            transform: scale(1);
        }

        /* Announcement Bar */
        .scrolling-text {
            width: 100%;
            overflow: hidden;
        }
        
        .scrolling-text p {
            animation: scroll-left 15s linear infinite;
        }
        
        @keyframes scroll-left {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        /* Performance Meter */
        .perf-meter {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: conic-gradient(#34a853 0deg 120deg, #fbbc05 120deg 240deg, #ea4335 240deg 360deg);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .perf-meter::before {
            content: '';
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: white;
            position: absolute;
        }

        .dark .perf-meter::before { 
            background: #2d2e30; 
        }

        /* Quick Actions */
        .quick-actions {
            position: fixed;
            top: 50%;
            right: -200px;
            transform: translateY(-50%);
            background: white;
            border-radius: 12px 0 0 12px;
            box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
            padding: 12px 8px;
            transition: right 0.3s ease;
            z-index: 90;
        }

        .quick-actions.show { 
            right: 0; 
        }
        
        .dark .quick-actions { 
            background: #2d2e30; 
        }

        /* Validation Indicators */
        .validation-indicator {
            display: inline-flex;
            align-items: center;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            margin-right: 8px;
        }
        
        .validation-good {
            background-color: rgba(52, 168, 83, 0.1);
            color: #34a853;
        }
        
        .validation-bad {
            background-color: rgba(234, 67, 53, 0.1);
            color: #ea4335;
        }
        
        .dark .validation-good { 
            background-color: rgba(52, 168, 83, 0.2); 
        }
        
        .dark .validation-bad { 
            background-color: rgba(234, 67, 53, 0.2); 
        }

        /* Smart Chips */
        .smart-chip {
            background: linear-gradient(135deg, #ff9a56, #ff6b6b);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            margin: 4px;
        }

        .smart-chip:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3); 
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn { 
            animation: fadeIn 0.2s ease forwards; 
        }

        /* NEW: HTML Editor Styles */
        .editor-tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 8px;
        }
        
        .editor-tab {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
            background: #f8f9fa;
            border: 1px solid #e5e7eb;
        }
        
        .editor-tab.active {
            background: var(--blue-500);
            color: white;
            border-color: var(--blue-500);
        }
        
        .dark .editor-tab {
            background: #374151;
            border-color: #4b5563;
            color: #e5e7eb;
        }
        
        .dark .editor-tab.active {
            background: var(--blue-500);
            color: white;
        }
        
        .html-editor {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            line-height: 1.4;
        }
        
        /* NEW: Store Segmentation Styles */
        .store-segment {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            background: white;
            transition: all 0.2s ease;
        }
        
        .dark .store-segment {
            border-color: #4b5563;
            background: #374151;
        }
        
        .store-segment:hover {
            border-color: var(--blue-500);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .store-segment.pending {
            border-left: 4px solid var(--yellow-500);
        }
        
        .store-segment.processed {
            border-left: 4px solid var(--green-500);
        }
        
        .store-segment.error {
            border-left: 4px solid var(--red-500);
        }
        
        /* NEW: Auto Clicker Styles */
        .auto-clicker-panel {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        .clicker-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .clicker-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            padding: 8px 12px;
            color: white;
            font-size: 14px;
        }
        
        .clicker-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .clicker-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            padding: 8px 12px;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .clicker-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .clicker-btn.active {
            background: var(--green-500);
            border-color: var(--green-500);
        }
        
        .clicker-btn.stop {
            background: var(--red-500);
            border-color: var(--red-500);
        }
    </style>
</head>

<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen flex flex-col">
    <!-- Global Progress Bar -->
    <div id="globalProgressBar">
        <div class="progress-bar"></div>
    </div>

    <!-- Header Section -->
    <header class="bg-white dark:bg-gray-800 py-4 shadow-sm border-b border-gray-200 dark:border-gray-700 sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center px-4 md:px-6">
            <!-- Branding -->
            <div class="flex items-center space-x-4">
                <div class="flex items-center space-x-3">
                    <img src="https://res.cloudinary.com/dib5bkbsy/image/upload/v1732499785/icons8-mail-32_z9jaip.png" alt="Scoutier Logo" class="w-6 h-6">
                    <h1 class="text-2xl font-bold" style="color:#4CAF50;">Scoutier</h1>
                    <span class="text-xs px-2 py-1 rounded-full font-medium" style="background-color:#FF5722; color:#FFEB3B;">
                        PWA
                    </span>
                </div>
            </div>

            <!-- Social Links & Performance -->
            <div class="flex justify-center items-center gap-4">
                <div class="perf-meter hidden md:flex">
                    <span id="perfScore" class="text-xs font-bold z-10">98</span>
                </div>
                <a href="https://www.x.com/justeldev" class="text-black dark:text-gray-400 hover:text-blue-500 transition-all p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full">
                    <i class="ri-twitter-x-fill text-xl"></i>
                </a>
            </div>
            
            <!-- Stats & Theme Toggle -->
            <div class="flex items-center space-x-4">
                <div class="hidden md:flex items-center space-x-6 mr-4">
                    <div class="flex items-center space-x-2">
                        <i class="ri-check-double-line text-green-500"></i>
                        <span class="text-sm font-medium"><span id="headerSentCount" class="font-semibold">0</span> sent</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <i class="ri-time-line text-blue-500"></i>
                        <span class="text-sm font-medium"><span id="headerRemainingCount" class="font-semibold">0</span> pending</span>
                    </div>
                </div>

                <div class="relative">
                    <button id="darkModeToggle" class="text-blue-500 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-all p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700">
                        <i class="ri-moon-line ri-lg hidden" id="darkIcon"></i>
                        <i class="ri-sun-line ri-lg" id="lightIcon"></i>
                    </button>

                    <ul id="themeMenu" class="absolute right-0 top-11 mt-2 w-48 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 shadow-lg rounded-lg opacity-0 invisible transition-all duration-300 z-50 border border-gray-200 dark:border-gray-700">
                        <li data-theme="system" class="p-3 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded-t-lg flex items-center gap-2">
                            <i class="ri-device-line text-green-500"></i> System
                        </li>
                        <li data-theme="light" class="p-3 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer flex items-center gap-2">
                            <i class="ri-sun-line text-yellow-500"></i> Light
                        </li>
                        <li data-theme="dark" class="p-3 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded-b-lg flex items-center gap-2">
                            <i class="ri-moon-line text-blue-500"></i> Dark
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    <!-- Announcement Bar -->
    <section class="bg-orange-50 border border-orange-200 rounded-xl text-orange-700 p-2 text-center flex items-center justify-between mx-2 mt-3 shadow-sm">
        <div class="flex items-center overflow-hidden">
            <i class="ri-megaphone-line text-lg mr-2 text-orange-500"></i>
            <div class="scrolling-text whitespace-nowrap">
                <p id="announcementText" class="inline-block px-2">
                    NEW: HTML Email Editor, Store Segmentation & Auto Clicker features added!
                </p>
            </div>
        </div>
        <button onclick="copyAnnouncement()" class="ml-3 px-2 py-1 rounded-lg text-sm flex items-center gap-1 text-orange-600 hover:bg-orange-100 transition">
            <i class="ri-file-copy-line"></i> Copy
        </button>
    </section>

    <!-- Search Bar -->
    <div class="search-container py-4 sticky top-16 z-40">
        <div class="container mx-auto px-4">
            <div class="relative max-w-2xl mx-auto">
                <div class="flex items-center border border-gray-300 dark:border-gray-600 rounded-xl overflow-hidden shadow-sm focus-within:ring-2 focus-within:ring-blue-500 transition-all bg-white dark:bg-gray-800">
                    <i class="ri-search-line px-4 text-gray-400 dark:text-gray-500 text-xl flex-shrink-0"></i>
                    <input 
                        type="text" 
                        id="globalEmailSearch" 
                        placeholder="Search emails globally or use AI commands..." 
                        class="flex-1 min-w-0 px-3 py-4 bg-transparent focus:outline-none text-gray-700 dark:text-gray-300"
                    />
                    <div class="px-3 flex items-center space-x-2 flex-shrink-0">
                        <button id="aiAssistBtn" class="smart-chip">
                            <i class="ri-sparkling-line mr-1"></i> AI
                        </button>
                    </div>
                </div>
                
                <!-- Search Suggestions -->
                <div id="searchSuggestions" class="absolute top-full left-0 right-0 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg mt-2 hidden z-50">
                    <div class="p-4 space-y-2">
                        <div class="text-xs font-medium text-gray-500 dark:text-gray-400 mb-2">AI Commands</div>
                        <button class="w-full text-left px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg" data-command="find:gmail">Find all Gmail addresses</button>
                        <button class="w-full text-left px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg" data-command="sort:domain">Sort by domain</button>
                        <button class="w-full text-left px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg" data-command="filter:unsent">Show only unsent</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions Toolbar -->
    <div id="quickActions" class="quick-actions">
        <div class="flex flex-col gap-3">
            <button id="quickSchedule" class="p-3 rounded-full bg-purple-500 text-white hover:bg-purple-600 transition-colors" title="Quick Schedule">
                <i class="ri-calendar-schedule-line"></i>
            </button>
            <button id="quickExport" class="p-3 rounded-full bg-green-500 text-white hover:bg-green-600 transition-colors" title="Quick Export">
                <i class="ri-download-cloud-line"></i>
            </button>
            <button id="quickStats" class="p-3 rounded-full bg-blue-500 text-white hover:bg-blue-600 transition-colors" title="Quick Stats">
                <i class="ri-bar-chart-line"></i>
            </button>
            <button id="toggleQuickActions" class="p-2 rounded-full bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300">
                <i class="ri-arrow-right-line" id="quickActionsIcon"></i>
            </button>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container mx-auto px-4 flex-grow py-6">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <!-- Left Column (3/4) -->
            <div class="lg:col-span-3 space-y-6">
                <!-- NEW: Auto Clicker Panel -->
                <div class="auto-clicker-panel">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-medium flex items-center gap-2">
                            <i class="ri-cursor-line"></i>
                            Auto Clicker
                        </h3>
                        <div class="flex items-center gap-2">
                            <span class="text-sm opacity-90">Status:</span>
                            <div class="w-2 h-2 bg-red-500 rounded-full" id="clickerStatus"></div>
                        </div>
                    </div>
                    
                    <div class="clicker-controls">
                        <input type="number" id="clickInterval" class="clicker-input" placeholder="Interval (ms)" value="1000" min="100" max="10000">
                        <input type="number" id="clickDuration" class="clicker-input" placeholder="Duration (s)" value="30" min="5" max="3600">
                        <input type="number" id="clickLimit" class="clicker-input" placeholder="Click Limit" value="50" min="1" max="1000">
                        <button id="startClicker" class="clicker-btn">
                            <i class="ri-play-line mr-1"></i> Start
                        </button>
                        <button id="stopClicker" class="clicker-btn stop">
                            <i class="ri-stop-line mr-1"></i> Stop
                        </button>
                    </div>
                    
                    <div class="text-xs opacity-80">
                        <i class="ri-information-line mr-1"></i>
                        Auto-clicks generated email links. Make sure pop-ups are allowed.
                    </div>
                </div>

                <!-- Main Tool Form -->
                <div class="gmail-card p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-xl font-bold flex items-center gap-2 text-green-500 dark:text-gray-100">
                            <i class="ri-send-plane-fill text-red-500"></i>
                            Fast Mail Send
                        </h2>
                        <div class="flex items-center gap-2">
                            <span class="text-sm text-blue-500 dark:text-blue-400 font-medium">Status:</span>
                            <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                        </div>
                    </div>

                    <form id="emailForm" class="space-y-5">
                        <!-- Recipients Section -->
                        <div>
                            <label for="recipients" class="block text-sm font-medium flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2">
                                <i class="ri-mail-line text-blue-500"></i>
                                Recipients Email <small class="ml-2 text-xs text-gray-500 dark:text-gray-400">(Max 10,000)</small>
                                <button type="button" id="smartExtract" class="smart-chip ml-auto text-xs">
                                    <i class="ri-magic-line mr-1"></i> AI Smart Fix
                                </button>
                            </label>
                            <div class="relative">
                                <textarea
                                    id="recipients"
                                    class="w-full gmail-input resize-none"
                                    rows="5"
                                    placeholder="Enter each email on a new line or paste mixed content for smart extraction"
                                    required
                                ></textarea>
                                <div class="absolute bottom-2 right-2 flex gap-2">
                                    <button type="button" id="clearRecipients" class="text-xs text-red-500 hover:text-red-700">
                                        <i class="ri-close-circle-line"></i> Clear
                                    </button>
                                    <button type="button" id="validateEmails" class="text-xs text-blue-500 hover:text-blue-700">
                                        <i class="ri-shield-check-line"></i> Validate
                                    </button>
                                </div>
                            </div>
                            
                            <div class="flex flex-wrap items-center mt-2 text-xs text-gray-600 dark:text-gray-400">
                                <div id="validEmailsIndicator" class="validation-indicator validation-good mr-2 mb-1">
                                    <i class="ri-checkbox-circle-line mr-1"></i>
                                    <span>Valid: <span id="validEmails" class="font-medium">0</span></span>
                                </div>
                                <div id="invalidEmailsIndicator" class="validation-indicator validation-bad mr-2 mb-1">
                                    <i class="ri-error-warning-line mr-1"></i>
                                    <span>Invalid: <span id="invalidEmails" class="font-medium">0</span></span>
                                </div>
                                <div class="mr-2 mb-1">
                                    <span>Total: <span id="totalEmails" class="font-medium">0</span></span>
                                </div>
                                <div class="mr-2 mb-1">
                                    <span>Duplicates: <span id="duplicateEmails" class="font-medium text-yellow-600">0</span></span>
                                </div>
                            </div>
                        </div>

                        <!-- Subject Section -->
                        <div>
                            <label for="subject" class="block text-sm font-medium flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2">
                                <i class="ri-pencil-line text-yellow-500"></i>
                                Subject Line <small class="ml-2 text-xs text-gray-500 dark:text-gray-400">(Max 200 characters)</small>
                            </label>
                            <input
                                type="text"
                                id="subject"
                                class="w-full gmail-input"
                                placeholder="Email Subject - Use {name} for personalization"
                            />
                            
                            <!-- Subject Templates -->
                            <div class="flex flex-wrap mt-2">
                                <div class="template-chip" data-target="subject" data-template="Quick question about {company}">
                                    <i class="ri-question-line mr-1"></i> Quick question
                                </div>
                                <div class="template-chip" data-target="subject" data-template="Partnership opportunity with {name}">
                                    <i class="ri-handshake-line mr-1"></i> Partnership
                                </div>
                                <div class="template-chip" data-target="subject" data-template="Exclusive offer for {company}">
                                    <i class="ri-gift-line mr-1"></i> Exclusive offer
                                </div>
                            </div>
                            
                            <div class="flex justify-between mt-1">
                                <div class="flex gap-2">
                                    <button type="button" id="subjectAnalyzer" class="gmail-btn-secondary py-1 px-3 text-xs flex items-center gap-1">
                                        <i class="ri-search-eye-line"></i> Analyze
                                    </button>
                                    <button type="button" id="spamChecker" class="gmail-btn-secondary py-1 px-3 text-xs flex items-center gap-1">
                                        <i class="ri-shield-line"></i> Spam Check
                                    </button>
                                </div>
                                <span id="subjectCount" class="text-xs text-gray-500 dark:text-gray-400">0/200</span>
                            </div>
                        </div>

                        <!-- NEW: HTML Message Body Section -->
                        <div>
                            <label class="block text-sm font-medium flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2">
                                <i class="ri-file-text-line text-green-500"></i>
                                Message Body <small class="ml-2 text-xs text-gray-500 dark:text-gray-400">(HTML or Plain Text)</small>
                            </label>
                            
                            <!-- Editor Tabs -->
                            <div class="editor-tabs">
                                <button type="button" class="editor-tab active" data-editor="plain">Plain Text</button>
                                <button type="button" class="editor-tab" data-editor="html">HTML Editor</button>
                            </div>

                            <!-- Plain Text Editor -->
                            <div id="plainTextEditor" class="relative">
                                <textarea
                                    id="body"
                                    class="w-full gmail-input resize-none"
                                    rows="6"
                                    placeholder="Write your message here... Use {name} for names and {company} for companies"
                                    required
                                ></textarea>
                                <div class="absolute bottom-2 right-2 flex gap-2">
                                    <button type="button" id="grammarCheck" class="text-xs text-purple-500 hover:text-purple-700">
                                        <i class="ri-translate-line"></i> Grammar
                                    </button>
                                    <button type="button" id="toneAdjust" class="text-xs text-blue-500 hover:text-blue-700">
                                        <i class="ri-emotion-line"></i> Tone
                                    </button>
                                </div>
                            </div>

                            <!-- HTML Editor -->
                            <div id="htmlEditor" class="relative hidden">
                                <textarea
                                    id="htmlBody"
                                    class="w-full gmail-input resize-none html-editor"
                                    rows="6"
                                    placeholder="Paste your HTML code here... Use {name} and {company} for personalization"
                                ></textarea>
                                <div class="absolute bottom-2 right-2 flex gap-2">
                                    <button type="button" id="previewHTML" class="text-xs text-green-500 hover:text-green-700">
                                        <i class="ri-eye-line"></i> Preview
                                    </button>
                                    <button type="button" id="clearHTML" class="text-xs text-red-500 hover:text-red-700">
                                        <i class="ri-close-line"></i> Clear
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Body Templates -->
                            <div class="flex flex-wrap mt-2">
                                <div class="template-chip" data-target="body" data-template="Hi {name},&#10;&#10;I hope this email finds you well. I wanted to reach out about an exciting opportunity that could benefit {company}.&#10;&#10;Would you be available for a quick 15-minute call this week?&#10;&#10;Best regards,&#10;[Your Name]">
                                    <i class="ri-chat-1-line mr-1"></i> Professional
                                </div>
                                <div class="template-chip" data-target="body" data-template="Hello {name},&#10;&#10;I noticed your work at {company} and was impressed by your recent achievements. I'd love to discuss how we could potentially collaborate.&#10;&#10;Are you free for a coffee chat next week?&#10;&#10;Cheers,&#10;[Your Name]">
                                    <i class="ri-user-voice-line mr-1"></i> Casual
                                </div>
                                <div class="template-chip" data-target="html" data-template="&lt;div style='font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #e0e0e0; border-radius: 8px;'&gt;&lt;h2 style='color: #1a73e8;'&gt;Hello {name}!&lt;/h2&gt;&lt;p&gt;I came across {company} and was impressed by your work.&lt;/p&gt;&lt;p&gt;Would you be interested in exploring potential collaboration opportunities?&lt;/p&gt;&lt;div style='margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 6px;'&gt;&lt;p style='margin: 0;'&gt;Best regards,&lt;br&gt;[Your Name]&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;">
                                    <i class="ri-code-line mr-1"></i> HTML Template
                                </div>
                            </div>
                            
                            <div class="flex justify-between items-center mt-2">
                                <div class="text-xs text-blue-600 dark:text-blue-400 flex items-center gap-4">
                                    <span><i class="ri-information-line mr-1"></i>Smart personalization enabled</span>
                                    <span id="editorMode">Plain Text</span>
                                </div>
                                <span id="bodyCount" class="text-xs text-gray-500 dark:text-gray-400">0/5000</span>
                            </div>
                        </div>

                        <!-- Advanced Options -->
                        <div class="bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-medium text-gray-800 dark:text-gray-200">Advanced Options</h4>
                                <button type="button" id="toggleAdvanced" class="text-xs text-blue-500 hover:text-blue-700">
                                    <i class="ri-arrow-down-s-line" id="advancedIcon"></i> Expand
                                </button>
                            </div>
                            <div id="advancedOptions" class="hidden space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm text-gray-700 dark:text-gray-300 mb-1">Send Interval (seconds)</label>
                                        <input type="number" id="sendInterval" class="gmail-input w-full" value="10" min="1" max="300">
                                    </div>
                                    <div>
                                        <label class="block text-sm text-gray-700 dark:text-gray-300 mb-1">Batch Size</label>
                                        <input type="number" id="batchSize" class="gmail-input w-full" value="50" min="10" max="500">
                                    </div>
                                </div>
                                <div class="flex items-center gap-4">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" id="skipDuplicates" checked class="w-4 h-4 text-blue-500 rounded">
                                        <span class="text-sm text-gray-700 dark:text-gray-300">Skip duplicate emails</span>
                                    </label>
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" id="trackOpens" class="w-4 h-4 text-blue-500 rounded">
                                        <span class="text-sm text-gray-700 dark:text-gray-300">Track email opens</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Submit Button -->
                        <button type="submit" class="w-full gmail-btn py-3 px-6 rounded-lg flex items-center justify-center gap-2 text-lg font-semibold">
                            <i class="ri-rocket-line text-xl"></i>
                            Generate Emails
                        </button>
                    </form>
                </div>

                <!-- NEW: Store Segmentation Section -->
                <div class="gmail-card p-6">
                    <h4 class="text-lg font-medium flex items-center gap-2 mb-3 text-purple-500 dark:text-gray-100">
                        <i class="ri-store-2-line text-purple-500 text-xl"></i>
                        Store Segmentation
                    </h4>

                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">
                        Paste multiple store URLs (one per line) to extract and segment emails with pending tracking.
                    </p>

                    <div class="relative mb-4">
                        <textarea
                            id="storeUrls"
                            class="w-full gmail-input resize-none"
                            rows="4"
                            placeholder="Paste store URLs here, one per line...&#10;Example:&#10;https://store1.example.com&#10;https://shop2.example.com&#10;https://boutique3.example.net"
                        ></textarea>
                        <div class="absolute bottom-2 right-2 flex gap-2">
                            <button type="button" id="clearStores" class="text-xs text-red-500 hover:text-red-700">
                                <i class="ri-close-circle-line"></i> Clear
                            </button>
                            <button type="button" id="extractStores" class="text-xs text-green-500 hover:text-green-700">
                                <i class="ri-download-line"></i> Extract
                            </button>
                        </div>
                    </div>

                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm text-gray-600 dark:text-gray-400">
                            Found: <span id="storeCount" class="font-medium">0</span> stores
                        </span>
                        <div class="flex gap-2">
                            <button id="processAllStores" class="gmail-btn-secondary py-1 px-3 text-xs">
                                <i class="ri-play-line mr-1"></i> Process All
                            </button>
                            <button id="exportStores" class="gmail-btn-secondary py-1 px-3 text-xs">
                                <i class="ri-download-line mr-1"></i> Export
                            </button>
                        </div>
                    </div>

                    <div id="storeSegments" class="space-y-2 max-h-96 overflow-y-auto">
                        <!-- Store segments will appear here -->
                    </div>
                </div>

                <!-- File Upload Section -->
                <div class="gmail-card p-6">
                    <h4 class="text-lg font-medium flex items-center gap-2 mb-3 text-green-500 dark:text-gray-100">
                        <i class="ri-upload-cloud-line text-red-500 text-xl"></i>
                        Smart File Upload
                    </h4>

                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">
                        Upload CSV, TXT, or Excel files. AI will automatically extract and clean email addresses.
                    </p>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <label for="csvUpload" class="cursor-pointer gmail-btn-secondary py-3 px-4 rounded-lg transition-all flex items-center gap-2 justify-center hover:scale-105">
                            <i class="ri-file-add-line text-blue-500"></i> Choose File
                        </label>
                        <input type="file" id="csvUpload" class="hidden" accept=".csv,.txt,.xlsx,.xls" />
                        
                        <div id="fileName" class="text-sm truncate flex items-center text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 px-3 py-3 rounded-lg">
                            <i class="ri-file-line mr-2"></i>
                            No file selected
                        </div>

                        <button id="uploadCSV" class="gmail-btn py-3 px-4 rounded-lg transition-all flex items-center gap-2 justify-center hover:scale-105">
                            <i class="ri-upload-cloud-line"></i>
                            Smart Upload
                        </button>
                    </div>
                </div>
                
                <!-- Email Templates Section -->
                <div class="gmail-card p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h4 class="text-lg font-medium flex items-center gap-2 text-blue-500 dark:text-gray-100">
                            <i class="ri-file-list-3-line text-blue-500"></i>
                            Smart Templates
                        </h4>
                    </div>
                    
                    <div id="templatesContainer" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- AI-Enhanced Templates -->
                        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:border-blue-300 dark:hover:border-blue-700 transition-all cursor-pointer" data-template-subject="Smart follow-up with {name}" data-template-body="Hi {name},&#10;&#10;I hope you're doing well at {company}. I'm following up on our previous conversation about potential collaboration opportunities.&#10;&#10;Based on your recent achievements, I believe we could create something amazing together. Would you have 15 minutes this week for a quick call?&#10;&#10;Looking forward to hearing from you.&#10;&#10;Best regards,&#10;[Your Name]">
                            <div class="flex justify-between items-start mb-2">
                                <h5 class="font-medium text-gray-800 dark:text-gray-200">AI-Enhanced Follow-up</h5>
                                <span class="text-xs bg-gradient-to-r from-blue-500 to-purple-500 text-white px-2 py-0.5 rounded">AI Optimized</span>
                            </div>
                            <p class="text-sm text-gray-500 dark:text-gray-400 mb-3">Smart follow-up with personalization and engagement hooks.</p>
                            <button class="text-xs text-blue-500 hover:text-blue-700 dark:hover:text-blue-300 flex items-center">
                                <i class="ri-sparkling-line mr-1"></i> Use AI Template
                            </button>
                        </div>
                        
                        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:border-blue-300 dark:hover:border-blue-700 transition-all cursor-pointer" data-template-subject="Exclusive opportunity for {company}" data-template-body="Dear {name},&#10;&#10;I've been following {company}'s impressive growth in the industry, and I'm excited to share an exclusive opportunity that aligns perfectly with your goals.&#10;&#10;Our latest solution has helped similar companies increase their efficiency by 40%. I'd love to show you how it can benefit {company} specifically.&#10;&#10;Would you be available for a 20-minute demo this week?&#10;&#10;Best regards,&#10;[Your Name]">
                            <div class="flex justify-between items-start mb-2">
                                <h5 class="font-medium text-gray-800 dark:text-gray-200">Smart Business Pitch</h5>
                                <span class="text-xs bg-gradient-to-r from-green-500 to-yellow-500 text-white px-2 py-0.5 rounded">High Convert</span>
                            </div>
                            <p class="text-sm text-gray-500 dark:text-gray-400 mb-3">Data-driven pitch template with proven conversion rates.</p>
                            <button class="text-xs text-blue-500 hover:text-blue-700 dark:hover:text-blue-300 flex items-center">
                                <i class="ri-trophy-line mr-1"></i> Use Smart Template
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column (1/4) -->
            <div class="lg:col-span-1 space-y-6">
                <!-- Campaign Stats Card -->
                <div class="gmail-card p-6 bg-gradient-to-br from-blue-500 to-purple-600 text-white">
                    <h3 class="text-lg font-medium flex items-center gap-2 mb-4">
                        <i class="ri-dashboard-line"></i>
                        Live Dashboard
                    </h3>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="bg-white/15 rounded-lg p-3 text-center backdrop-filter backdrop-blur-sm">
                            <div class="text-2xl font-bold" id="sentCounter">0</div>
                            <div class="text-xs opacity-80">Sent</div>
                        </div>
                        <div class="bg-white/15 rounded-lg p-3 text-center backdrop-filter backdrop-blur-sm">
                            <div class="text-2xl font-bold" id="remainingCounter">0</div>
                            <div class="text-xs opacity-80">Remaining</div>
                        </div>
                    </div>
                    
                    <div class="bg-white/15 rounded-lg p-3 text-center mb-4 backdrop-filter backdrop-blur-sm">
                        <div class="text-3xl font-bold" id="totalCounter">0</div>
                        <div class="text-xs opacity-80">Total Generated</div>
                    </div>
                    
                    <!-- Live Progress Ring -->
                    <div class="relative w-20 h-20 mx-auto mb-3">
                        <svg class="w-20 h-20 transform -rotate-90" viewBox="0 0 36 36">
                            <path class="text-white/20" stroke="currentColor" stroke-width="3" fill="none" d="m18,2.0845 a 15.9155,15.9155 0 0,1 0,31.831 a 15.9155,15.9155 0 0,1 0,-31.831"/>
                            <path id="progressRing" class="text-white" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="0, 100" d="m18,2.0845 a 15.9155,15.9155 0 0,1 0,31.831 a 15.9155,15.9155 0 0,1 0,-31.831"/>
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <span id="campaignProgressText" class="text-sm font-bold">0%</span>
                        </div>
                    </div>
                </div>

                <!-- Smart Analytics -->
                <div class="gmail-card p-6">
                    <h3 class="text-lg font-medium flex items-center gap-2 mb-4 text-gray-800 dark:text-gray-100">
                        <i class="ri-brain-line text-purple-500"></i>
                        Smart Analytics
                    </h3>
                    
                    <div class="space-y-4">
                        <!-- Performance Score -->
                        <div class="text-center">
                            <div class="relative inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-r from-green-400 to-blue-500 mb-2">
                                <span id="perfScore" class="text-white font-bold text-lg">A+</span>
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400">Performance Score</div>
                        </div>
                        
                        <!-- Domain Distribution -->
                        <div>
                            <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Top Domains</h4>
                            <div id="domainStats" class="space-y-2">
                                <div class="flex items-center justify-between text-xs">
                                    <span class="text-gray-600 dark:text-gray-400">No data available</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Real-time Activity -->
                        <div>
                            <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Live Activity</h4>
                            <div id="liveActivity" class="text-xs text-gray-500 dark:text-gray-400 h-20 overflow-y-auto bg-gray-50 dark:bg-gray-800 rounded p-2">
                                <div>Ready to start campaign...</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Generated Links Section -->
                <div class="gmail-card p-6">
                    <div id="mailtoLinks" class="hidden flex flex-col h-full">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="text-lg font-medium flex items-center gap-2 text-gray-800 dark:text-gray-100">
                                <i class="ri-links-line text-blue-500"></i>
                                Generated Emails
                            </h3>
                            
                            <!-- Action Buttons Dropdown -->
                            <div class="relative">
                                <button id="emailActionsBtn" class="p-1.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                    <i class="ri-more-2-fill text-gray-500 dark:text-gray-400"></i>
                                </button>
                                <div id="emailActionsMenu" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-10">
                                    <button id="copyEmails" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center rounded-t-lg">
                                        <i class="ri-file-copy-line mr-2"></i> Copy All Emails
                                    </button>
                                    <button id="exportAll" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center">
                                        <i class="ri-download-line mr-2"></i> Export All
                                    </button>
                                    <button id="clearHistory" class="w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center rounded-b-lg">
                                        <i class="ri-refresh-line mr-2"></i> Clear History
                                    </button>
                                </div>
                            </div>
                        </div>

                        <p class="text-xs text-gray-500 dark:text-gray-400 mb-3">
                            Click an email to open. Orange = clicked.
                        </p>

                        <!-- Generated Links Container -->
                        <div id="generatedLinks" class="space-y-1 text-sm text-gray-800 dark:text-gray-200 max-h-96 overflow-y-auto"></div>
                    </div>
                    
                    <!-- Empty State -->
                    <div id="emptyState" class="flex flex-col items-center justify-center py-8 text-center">
                        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mb-4">
                            <i class="ri-rocket-line text-white text-2xl"></i>
                        </div>
                        <h3 class="text-lg font-medium text-gray-800 dark:text-gray-200 mb-2">Ready to Launch</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">
                            Add recipients and generate your lightning-fast email campaign.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="mt-12 py-6 border-t border-gray-200 dark:border-gray-800 text-center text-sm text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800">
        <div class="container mx-auto px-4 space-y-4">
            <p>&copy; <span id="currentYear"></span> Scoutier PWA. Lightning-fast email outreach.</p>
            <p class="mt-1">Developed with ❤️ by <span class="font-medium text-blue-500">El Uthmaaniy</span></p>
            <button id="reset-app" class="gmail-btn-secondary py-2 px-4 mt-4 rounded-lg">
                <i class="ri-refresh-line mr-2"></i> Reset Campaign
            </button>
        </div>
    </footer>

    <!-- Floating Action Button -->
    <div id="scrollTopBtn" class="floating-btn">
        <i class="ri-arrow-up-line"></i>
    </div>

    <!-- NEW: HTML Preview Modal -->
    <div id="htmlPreviewModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl w-full max-w-4xl mx-4 h-4/5 flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold text-gray-800 dark:text-gray-200">HTML Email Preview</h2>
                <button id="closeHtmlPreview" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
                    <i class="ri-close-line text-xl"></i>
                </button>
            </div>
            
            <div class="flex gap-4 mb-4">
                <button id="previewDesktop" class="text-xs px-3 py-1 rounded bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300">Desktop</button>
                <button id="previewMobile" class="text-xs px-3 py-1 rounded bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300">Mobile</button>
                <button id="previewPlain" class="text-xs px-3 py-1 rounded bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300">Plain Text</button>
            </div>
            
            <div class="flex-1 bg-gray-100 dark:bg-gray-900 rounded-lg overflow-hidden">
                <iframe id="htmlPreviewFrame" class="w-full h-full border-0" sandbox="allow-same-origin"></iframe>
            </div>
            
            <div class="flex gap-3 mt-4">
                <button id="copyHtmlCode" class="gmail-btn-secondary py-2 px-4 rounded-lg flex items-center gap-2">
                    <i class="ri-file-copy-line"></i> Copy HTML
                </button>
                <button id="closeHtmlPreviewBtn" class="gmail-btn py-2 px-4 rounded-lg flex-1">Close Preview</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  
    <script>
        // Performance-optimized JavaScript with PWA features
        document.getElementById("currentYear").textContent = new Date().getFullYear();

        // PWA Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register(
                        'data:application/javascript;base64,c2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZXZlbnQgPT4ge30pOwpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2FjdGl2YXRlJywgZXZlbnQgPT4ge30pOwpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2ZldGNoJywgZXZlbnQgPT4gew0KICBldmVudC5yZXNwb25kV2l0aChmZXRjaChldmVudC5yZXF1ZXN0KSk7DQp9KTs='
                    );
                    console.log('PWA: Service Worker registered successfully');
                } catch (error) {
                    console.log('PWA: Service Worker registration failed:', error);
                }
            });
        }

        // Cached DOM Elements for lightning performance
        const elements = {
            // Existing elements...
            recipientsInput: document.getElementById('recipients'),
            subjectInput: document.getElementById('subject'),
            bodyInput: document.getElementById('body'),
            htmlBody: document.getElementById('htmlBody'),
            subjectCount: document.getElementById('subjectCount'),
            bodyCount: document.getElementById('bodyCount'),
            emailForm: document.getElementById('emailForm'),
            mailtoLinks: document.getElementById('mailtoLinks'),
            emptyState: document.getElementById('emptyState'),
            globalEmailSearch: document.getElementById('globalEmailSearch'),
            scrollTopBtn: document.getElementById('scrollTopBtn'),
            emailActionsBtn: document.getElementById('emailActionsBtn'),
            emailActionsMenu: document.getElementById('emailActionsMenu'),
            templatesContainer: document.getElementById('templatesContainer'),
            globalProgressBar: document.getElementById('globalProgressBar'),
            globalProgressInner: document.querySelector('#globalProgressBar .progress-bar'),
            sentCounter: document.getElementById('sentCounter'),
            remainingCounter: document.getElementById('remainingCounter'),
            totalCounter: document.getElementById('totalCounter'),
            headerSentCount: document.getElementById('headerSentCount'),
            headerRemainingCount: document.getElementById('headerRemainingCount'),
            progressRing: document.getElementById('progressRing'),
            campaignProgressText: document.getElementById('campaignProgressText'),
            darkModeToggle: document.getElementById('darkModeToggle'),
            themeMenu: document.getElementById('themeMenu'),
            lightIcon: document.getElementById('lightIcon'),
            darkIcon: document.getElementById('darkIcon'),
            copyEmails: document.getElementById('copyEmails'),
            exportAll: document.getElementById('exportAll'),
            clearHistory: document.getElementById('clearHistory'),
            quickActions: document.getElementById('quickActions'),
            toggleQuickActions: document.getElementById('toggleQuickActions'),
            quickActionsIcon: document.getElementById('quickActionsIcon'),
            resetApp: document.getElementById('reset-app'),
            csvUpload: document.getElementById('csvUpload'),
            fileName: document.getElementById('fileName'),
            uploadCSV: document.getElementById('uploadCSV'),
            validEmails: document.getElementById('validEmails'),
            invalidEmails: document.getElementById('invalidEmails'),
            totalEmails: document.getElementById('totalEmails'),
            duplicateEmails: document.getElementById('duplicateEmails'),
            validEmailsIndicator: document.getElementById('validEmailsIndicator'),
            invalidEmailsIndicator: document.getElementById('invalidEmailsIndicator'),
            smartExtract: document.getElementById('smartExtract'),
            clearRecipients: document.getElementById('clearRecipients'),
            validateEmails: document.getElementById('validateEmails'),
            subjectAnalyzer: document.getElementById('subjectAnalyzer'),
            spamChecker: document.getElementById('spamChecker'),
            grammarCheck: document.getElementById('grammarCheck'),
            toneAdjust: document.getElementById('toneAdjust'),
            toggleAdvanced: document.getElementById('toggleAdvanced'),
            advancedOptions: document.getElementById('advancedOptions'),
            advancedIcon: document.getElementById('advancedIcon'),
            searchSuggestions: document.getElementById('searchSuggestions'),
            aiAssistBtn: document.getElementById('aiAssistBtn'),
            quickSchedule: document.getElementById('quickSchedule'),
            quickExport: document.getElementById('quickExport'),
            quickStats: document.getElementById('quickStats'),
            domainStats: document.getElementById('domainStats'),
            liveActivity: document.getElementById('liveActivity'),
            perfScore: document.getElementById('perfScore'),
            
            // NEW: HTML Editor Elements
            plainTextEditor: document.getElementById('plainTextEditor'),
            htmlEditor: document.getElementById('htmlEditor'),
            editorTabs: document.querySelectorAll('.editor-tab'),
            previewHTML: document.getElementById('previewHTML'),
            clearHTML: document.getElementById('clearHTML'),
            htmlPreviewModal: document.getElementById('htmlPreviewModal'),
            htmlPreviewFrame: document.getElementById('htmlPreviewFrame'),
            closeHtmlPreview: document.getElementById('closeHtmlPreview'),
            closeHtmlPreviewBtn: document.getElementById('closeHtmlPreviewBtn'),
            previewDesktop: document.getElementById('previewDesktop'),
            previewMobile: document.getElementById('previewMobile'),
            previewPlain: document.getElementById('previewPlain'),
            copyHtmlCode: document.getElementById('copyHtmlCode'),
            editorMode: document.getElementById('editorMode'),
            
            // NEW: Store Segmentation Elements
            storeUrls: document.getElementById('storeUrls'),
            clearStores: document.getElementById('clearStores'),
            extractStores: document.getElementById('extractStores'),
            storeCount: document.getElementById('storeCount'),
            processAllStores: document.getElementById('processAllStores'),
            exportStores: document.getElementById('exportStores'),
            storeSegments: document.getElementById('storeSegments'),
            
            // NEW: Auto Clicker Elements
            clickInterval: document.getElementById('clickInterval'),
            clickDuration: document.getElementById('clickDuration'),
            clickLimit: document.getElementById('clickLimit'),
            startClicker: document.getElementById('startClicker'),
            stopClicker: document.getElementById('stopClicker'),
            clickerStatus: document.getElementById('clickerStatus')
        };

        // Lightning-fast data storage
        let emailData = {
            recipients: localStorage.getItem('recipients') || '',
            subject: localStorage.getItem('subject') || '',
            body: localStorage.getItem('body') || '',
            htmlBody: localStorage.getItem('htmlBody') || '',
            editorMode: localStorage.getItem('editorMode') || 'plain'
        };

        // Global variables with performance optimization
        let allTimeSent = new Set(JSON.parse(localStorage.getItem('allTimeSent') || '[]'));
        let domainStats = {};
        let allGeneratedEmails = [];
        let isAutoScheduled = false;
        let autoSendInterval = null;
        let currentEmailIndex = 0;
        let isPaused = false;
        let currentFilter = 'all';
        let selectedEmails = new Set();
        let lastClearedHistory = null;
        
        // NEW: Store Segmentation Variables
        let storeSegmentsData = JSON.parse(localStorage.getItem('storeSegments') || '[]');
        let currentEditorMode = emailData.editorMode;
        
        // NEW: Auto Clicker Variables
        let autoClickerInterval = null;
        let clickerRunning = false;
        let clickCount = 0;
        let clickStartTime = null;

        // Set initial values
        elements.recipientsInput.value = emailData.recipients;
        elements.subjectInput.value = emailData.subject;
        elements.bodyInput.value = emailData.body;
        elements.htmlBody.value = emailData.htmlBody;
        
        // Initialize editor mode
        switchEditorMode(currentEditorMode);

        // NEW: HTML Editor Functionality
        function switchEditorMode(mode) {
            currentEditorMode = mode;
            localStorage.setItem('editorMode', mode);
            
            // Update UI
            elements.editorTabs.forEach(tab => {
                tab.classList.toggle('active', tab.dataset.editor === mode);
            });
            
            elements.plainTextEditor.classList.toggle('hidden', mode !== 'plain');
            elements.htmlEditor.classList.toggle('hidden', mode !== 'html');
            elements.editorMode.textContent = mode === 'plain' ? 'Plain Text' : 'HTML Editor';
            
            // Update character count based on active editor
            updateCharacterCount();
        }

        // Editor tab switching
        elements.editorTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                switchEditorMode(tab.dataset.editor);
            });
        });

        // HTML Preview functionality
        elements.previewHTML.addEventListener('click', previewHtmlEmail);
        elements.closeHtmlPreview.addEventListener('click', closeHtmlPreview);
        elements.closeHtmlPreviewBtn.addEventListener('click', closeHtmlPreview);
        elements.htmlPreviewModal.addEventListener('click', (e) => {
            if (e.target === elements.htmlPreviewModal) closeHtmlPreview();
        });

        function previewHtmlEmail() {
            const htmlContent = elements.htmlBody.value;
            if (!htmlContent.trim()) {
                showAlert('Please enter some HTML content first.', 'warning');
                return;
            }
            
            const previewFrame = elements.htmlPreviewFrame;
            const previewDoc = previewFrame.contentDocument || previewFrame.contentWindow.document;
            
            // Basic HTML template with responsive design
            const fullHtml = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <style>
                        body { 
                            margin: 0; 
                            padding: 20px; 
                            font-family: Arial, sans-serif;
                            background: #f8f9fa;
                        }
                        .email-container {
                            max-width: 600px;
                            margin: 0 auto;
                            background: white;
                            border-radius: 8px;
                            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                            overflow: hidden;
                        }
                        @media (max-width: 600px) {
                            body { padding: 10px; }
                            .email-container { border-radius: 0; }
                        }
                    </style>
                </head>
                <body>
                    <div class="email-container">
                        ${htmlContent}
                    </div>
                </body>
                </html>
            `;
            
            previewDoc.open();
            previewDoc.write(fullHtml);
            previewDoc.close();
            
            elements.htmlPreviewModal.classList.remove('hidden');
        }

        function closeHtmlPreview() {
            elements.htmlPreviewModal.classList.add('hidden');
        }

        // Preview mode switching
        elements.previewDesktop.addEventListener('click', () => setPreviewMode('desktop'));
        elements.previewMobile.addEventListener('click', () => setPreviewMode('mobile'));
        elements.previewPlain.addEventListener('click', () => setPreviewMode('plain'));

        function setPreviewMode(mode) {
            const buttons = [elements.previewDesktop, elements.previewMobile, elements.previewPlain];
            buttons.forEach(btn => {
                btn.classList.remove('bg-blue-100', 'text-blue-700', 'dark:bg-blue-900/30', 'dark:text-blue-300');
                btn.classList.add('bg-gray-100', 'text-gray-700', 'dark:bg-gray-700', 'dark:text-gray-300');
            });
            
            const activeBtn = elements[`preview${mode.charAt(0).toUpperCase() + mode.slice(1)}`];
            activeBtn.classList.remove('bg-gray-100', 'text-gray-700', 'dark:bg-gray-700', 'dark:text-gray-300');
